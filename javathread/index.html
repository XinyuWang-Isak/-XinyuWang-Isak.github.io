<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>Java.Thread | Isak&#39;s Study Life</title>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://XinyuWang-Isak.github.io/favicon.ico?v=1626650486709">
<link rel="stylesheet" href="https://XinyuWang-Isak.github.io/styles/main.css">



<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>



    <meta name="description" content="
1. Thread, Runnable, Callable

1.1 Declare a class as a sub class of Thread
1.2 Declare a class as an implementation cl..." />
    <meta name="keywords" content="" />
  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://XinyuWang-Isak.github.io">
        <img src="https://XinyuWang-Isak.github.io/images/avatar.png?v=1626650486709" class="site-logo">
        <h1 class="site-title">Isak&#39;s Study Life</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            Prime page
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            Draft
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            Labels
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            About
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      Be a better person than yesterday.
    </div>
    <div class="site-footer">
      Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="https://XinyuWang-Isak.github.io/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">Java.Thread</h2>
            <div class="post-date">2021-07-16</div>
            
            <div class="post-content" v-pre>
              <ul>
<li><a href="#1-thread-runnable-callable">1. Thread, Runnable, Callable</a>
<ul>
<li><a href="#11-declare-a-class-as-a-sub-class-of-thread">1.1 Declare a class as a sub class of Thread</a></li>
<li><a href="#12-declare-a-class-as-an-implementation-class-of-the-runnable-interface">1.2 Declare a class as an implementation class of the Runnable interface.</a></li>
<li><a href="#13-summary">1.3 Summary</a></li>
<li><a href="#14--implement-callable-interface">1.4  Implement Callable interface.</a></li>
</ul>
</li>
<li><a href="#2-static-proxy">2. Static proxy</a></li>
</ul>
<h1 id="1-thread-runnable-callable">1. Thread, Runnable, Callable</h1>
<h2 id="11-declare-a-class-as-a-sub-class-of-thread">1.1 Declare a class as a sub class of Thread</h2>
<p>This sub class should override run() method.</p>
<pre><code>// Create Thread: Extend Class Thread, override run() method, call start to open thread.
public class ThreadTest extends Thread{
    @Override
    public void run(){
        for (int i = 1; i &lt; 200; i++){
            System.out.println(&quot;Learning &quot;+i);
        }
    }

    public static void main(String[] args){
        //main Thread.

        //Create a thread object.
        ThreadTest threadTest = new ThreadTest();

        //Call start()to open thread.
        threadTest.start();

        for (int i = 1; i &lt; 200; i++){
            System.out.println(&quot;Coding &quot;+i);
        }
    }
}
</code></pre>
<h2 id="12-declare-a-class-as-an-implementation-class-of-the-runnable-interface">1.2 Declare a class as an implementation class of the Runnable interface.</h2>
<p>That class then implements the run method. An instance of the class can then be allocated, passed as an argument when creating Thread, and started.</p>
<pre><code>//Implement runnable interface, override run() method, initialise and call the start() method.
public class ThreadTest3 implements Runnable{

    @Override
    public void run(){
        for (int i = 0; i &lt; 200; i++){
            System.out.println(&quot;Learning: &quot; + i);
        }
    }

    public static void main(String[] args){
        //Create the implement class object of runnable interface.
        ThreadTest3 testThread3 = new ThreadTest3();
        //Create the Thread object, start the execution by the object.
        new Thread(testThread3).start();

        for (int i = 0; i &lt; 200; i++){
            System.out.println(&quot;Coding: &quot; + i);
        }

    }
}
</code></pre>
<h2 id="13-summary">1.3 Summary</h2>
<p>Two ways to create a new thread of execution</p>
<p>(1) Extend Class</p>
<ul>
<li>Sub class extends Thread to have ability of multiple threads.</li>
<li>Start thread: SubclassObject.start();</li>
<li>Not recommended: The limitation of Java single inheritance.</li>
</ul>
<p>(2) Implement  interface</p>
<ul>
<li>Declare a class implements the Runnable interface.</li>
<li>Start thread: Pass an object of this ImplementedClass as a parameter into Thread Class's constructor.<br>
ThreadTest threadTest = new ThreadTest();<br>
Thread thread = new Thread(threadTest);<br>
thread.start();</li>
<li>Recommended: Avoid the limitation of Java single inheritance. Flexible and convinent for an object to be used by multiple threads.</li>
</ul>
<h3 id="a-tickets-program">A  tickets program.</h3>
<pre><code>//Issue found:
// The threads are unsafe and the data may be chaos when same resource operated by multiple threads.
public class ThreadTest4 implements Runnable{
    private int ticketNums = 10;

    @Override
    public void run(){
        while (ticketNums &gt; 0)
        {
            //Simulation of time delay.
            try{
                Thread.sleep(100);
            } catch (InterruptedException e){
                e.printStackTrace();
            }
            System.out.println(Thread.currentThread().getName() + &quot; get the &quot; + ticketNums-- + &quot; ticket&quot;);
        }
    }

    public static void main(String[] args){
        ThreadTest4 ticket = new ThreadTest4();

        new Thread(ticket, &quot;John&quot;).start();
        new Thread(ticket, &quot;Ash&quot;).start();
        new Thread(ticket, &quot;Lisa&quot;).start();

    }
}
</code></pre>
<p>This code's execution result is:</p>
<pre><code>Ash get the 10 ticket
Lisa get the 9 ticket
John get the 10 ticket
Lisa get the 8 ticket
John get the 7 ticket
Ash get the 6 ticket
Lisa get the 5 ticket
John get the 4 ticket
Ash get the 3 ticket
John get the 2 ticket
Lisa get the 1 ticket
Ash get the 0 ticket
Ash get the -1 ticket
</code></pre>
<p>Issue found:</p>
<pre><code>Ash get the 10 ticket
John get the 10 ticket
</code></pre>
<p>and</p>
<pre><code>Ash get the -1 ticket
</code></pre>
<p>The threads are unsafe and the data may be chaos when same resource operated by multiple threads.</p>
<h3 id="the-hare-and-the-tortoise">The Hare and the Tortoise</h3>
<pre><code>package com.isak.demo;

//Simulate the Hare and the Tortoise race.
public class Race implements Runnable{
    private static String winner;
    @Override
    public void run(){
        for (int i = 0; i &lt;= 100; i++){
            //Simulate the hare has a break
            if (Thread.currentThread().getName().equals(&quot;Hare&quot;) &amp;&amp; i%10 == 0){
                try{
                    Thread.sleep(10);
                } catch (InterruptedException e){
                    e.printStackTrace();
                }
            }

            //Determine if the game is over;
            boolean flag = gameOver(i);
            if (flag){
                break;
            }
            System.out.println(Thread.currentThread().getName() + &quot; has run &quot; + i + &quot; steps.&quot;);
        }
    }

    public boolean gameOver(int steps){
        if (winner != null{
            return true;
        }{
            if (steps == 100){
                winner = Thread.currentThread().getName();
                System.out.println(&quot;\nWinner is &quot; + winner + &quot;.&quot;);
                return true;
            }
        }
        return false;
    }

    public static void main(String[] args){
        Race race = new Race();

        new Thread(race, &quot;Hare&quot;).start();
        new Thread(race, &quot;Tortoise&quot;).start();
    }
}
</code></pre>
<p>Execution result:</p>
<pre><code>Tortoise has run 0 steps.
Hare has run 0 steps.
Tortoise has run 1 steps.
Hare has run 1 steps.
Tortoise has run 2 steps.
...
Tortoise has run 94 steps.
Tortoise has run 95 steps.
Tortoise has run 96 steps.
Tortoise has run 97 steps.
Tortoise has run 98 steps.
Tortoise has run 99 steps.

Winner is Tortoise.
</code></pre>
<h2 id="14-implement-callable-interface">1.4  Implement Callable interface.</h2>
<ul>
<li>
<ol>
<li>Implement Callable interface, return value is needed.</li>
</ol>
</li>
<li>
<ol start="2">
<li>Override call() method, Exception need to be thrown.</li>
</ol>
</li>
<li>
<ol start="3">
<li>Create target object.</li>
</ol>
</li>
<li>
<ol start="4">
<li>Create ExecutorService.</li>
</ol>
</li>
<li>
<ol start="5">
<li>Submit and execute.</li>
</ol>
</li>
<li>
<ol start="6">
<li>Acquire result.</li>
</ol>
</li>
<li>
<ol start="7">
<li>Shutdown service.</li>
</ol>
</li>
</ul>
<pre><code>import org.apache.commons.io.FileUtils;

import java.io.File;
import java.io.IOException;
import java.net.URL;
import java.util.concurrent.*;

//Implement Callable interface to create threads of execution to download images
public class TestCallable implements Callable&lt;Boolean&gt;{
    private String url;
    private String name;

    public TestCallable(String url, String name{
        this.url = url;
        this.name = name;
    }

    @Override
    public Boolean call(){
        WebDownloader webDownloader = new WebDownloader();
        webDownloader.downloader(url, name);
        System.out.println(name + &quot; downloaded.&quot;);
        return true;
    }

    public static void main(String[] args) throws ExecutionException, InterruptedException{
        TestCallable t1 = new TestCallable(&quot;https://thirdwx.qlogo.cn/mmopen/vi_32/Z8DQouPCMRZT1iaG8lBrAKYYAZibqz6XNCKzukNpoY32lPfA8ibWM1PZoPgwYuwNPw0bib8ypmZMNgjxgN9hQGqVEg/132&quot;, &quot;1.jpg&quot;);
        TestCallable t2 = new TestCallable(&quot;https://i2.hdslb.com/bfs/face/5146886e11073f5022cc7d163081f03ccb8d1c85.jpg@96w_96h_1c_1s.webp&quot;, &quot;2.jpg&quot;);
        TestCallable t3 = new TestCallable(&quot;https://i0.hdslb.com/bfs/face/2950f21db889c384f8f8c56b56e5668145ffbab3.jpg@96w_96h_1c_1s.webp&quot;, &quot;3.jpg&quot;);

        //Create ExecutorService.
        ExecutorService service = Executors.newFixedThreadPool(3);

        //Submit and execute.
        Future&lt;Boolean&gt; r1 = service.submit(t1);
        Future&lt;Boolean&gt; r2 = service.submit(t2);
        Future&lt;Boolean&gt; r3 = service.submit(t3);

        //Acquire result.

        boolean result1 = r1.get();
        boolean result2 = r2.get();
        boolean result3 = r3.get();

        System.out.println(result1);
        System.out.println(result2);
        System.out.println(result3);

        //Shutdown the service.
        service.shutdown();
    }

    class WebDownloader{
        public void downloader(String url, String name){
            try{
                FileUtils.copyURLToFile(new URL(url), new File(name));
            } catch (IOException e){
                e.printStackTrace();
            }
        }
    }

}
</code></pre>
<h2 id="advantages-of-implementing-callable-interface">Advantages of implementing Callable interface:</h2>
<ul>
<li>Can define return value.</li>
<li>Can throw exceptions.</li>
</ul>
<h1 id="2-lambda-expression">2. Lambda expression.</h1>
<p>λ is the 11th in Greek alphabet. Its essence belongs to the concept of functional programmin.</p>
<h2 id="21-advantage">2.1 Advantage</h2>
<ul>
<li>Avoid excessive internal anonymous classes.</li>
<li>Simplify codes and discard and the meaningless part.<br>
new Thread( ()-&gt;System.out.println(&quot;Lambda&quot;).start;</li>
</ul>
<h2 id="22-fuctional-interface">2.2 Fuctional Interface</h2>
<p>Fuctional interface is the key to learn lambda expression.<br>
Definition:</p>
<ul>
<li>It's a fuctional interface if there is only one abstract method in the interface.<br>
public interface Runnable<br>
{<br>
public<br>
}</li>
<li>We can</li>
</ul>
<h1 id="3-static-proxy">3. Static proxy</h1>
<ul>
<li>Actual object and proxy object must implement same interface.</li>
<li>The proxy object proxies the real object.</li>
</ul>
<pre><code>public class StaticProxy
{
    public static void main(String[] args)
    {
        WorkingCompany workingCompany = new WorkingCompany(new You());
        workingCompany.HappyWork();
    }

}

interface Work
{
    void HappyWork();
}

// Actual object works.
class You implements Work
{

    @Override
    public void HappyWork()
    {
        System.out.println(&quot;You are working!&quot;);
    }
}

// Proxy helps you work.
class WorkingCompany implements Work
{
    private Work target;

    public WorkingCompany(Work target)
    {
        this.target = target;
    }

    @Override
    public void HappyWork()
    {
        before();
        this.target.HappyWork();  // This is actual opbject.
        after();
    }

    private void after()
    {
        System.out.println(&quot;Learned skill.&quot;);
    }

    private void before()
    {
        System.out.println(&quot;Get paid.&quot;);
    }
}
</code></pre>
<h2 id="advantages">Advantages:</h2>
<ul>
<li>Proxy object can achieve things actual object can't do.</li>
<li>Actual object can focus on doing its own thing.</li>
</ul>

            </div>
            
            

            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script type="application/javascript">

AOS.init();

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>






  </body>
</html>
